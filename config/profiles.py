import ConfigParser


class Profiles(object):
    def __init__(self):
        self.__config = ConfigParser.ConfigParser()
        self.__fileName = "config/profiles.ini"
        self.__config.read(self.__fileName)

    def getCommand(self, name, command):
        try:
            return self.__config.get(name, command)
        except ConfigParser.Error:
            return None

    def getProfiles(self):
        profiles = {}
        for section in self.__config .sections():
            for (key, value) in self.__config.items(section):
                profiles[section] = value

        return profiles

    def removeProfile(self, name):
        try:
            self.__config.remove_section(name)
            with open(self.__fileName, "w") as configfile:
                self.__config.write(configfile)

            return True
        except ConfigParser.Error:
            return None

    def setProfile(self, name, command):
        if not self.__config.has_section(name):
            self.__config.add_section(name)
            self.__config.set(name, "command", command)

            with open(self.__fileName, "w") as configfile:
                self.__config.write(configfile)

            return True
        else:
            return None

