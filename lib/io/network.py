from re import search, M, I
from subprocess import Popen, PIPE, CalledProcessError

def arp(IP):
    try:
        pid = Popen(["arp", "-n", IP], stdout=PIPE)
        result = search(r"(([a-f\d]{1,2}\:){5}[a-f\d]{1,2})", pid.communicate()[0])

        if result:
            mac = result.groups()[0]
            oui = "".join(map(lambda i: mac.split(":")[i].upper(), range(3)))
            return mac, oui
        else:
            return None, None
    except CalledProcessError:
        return False

def ping(IP):
    try:
        ping = Popen(["ping","-c 1", IP], stdout=PIPE, stderr=PIPE)

        out, error = ping.communicate()

        if search(r'Unreachable', out, M|I):
            return False
        else:
            return True
    except CalledProcessError:
        return False
