from hashlib import md5
from re import search


class Parse(object):

    @staticmethod
    def dataToHash(data, type='s'):
        if type == 'f':
            return md5(open(data, 'rb').read()).hexdigest()
        else:
            return md5(data.encode()).hexdigest()

    @staticmethod
    def getContentFromFile(name):
        data = []
        try:
            f = open(name, 'r')
            for line in f.readlines():
                new = line.replace('\n', '')
                data.append(new)
        except IOError:
            pass
        finally:
            return data

    @staticmethod
    def sanatizeJSONInput(string):
        return str(string).replace("'", "").replace("{", "").replace("}", "")

    @staticmethod
    def sanatizeJSONOutput(data):
        out = {}
        data = data.replace(" ", "")
        c = data.split(",")

        for a in c:
            d = a.split(":")
            out[d[0]] = d[1]

        return out

    @staticmethod
    def removeHTML(html):
        try:
            g = search(r"href=\".*\">", html)
            link = str(g.group(0)).replace("href=\"", "").replace("\">", "")
            return link
        except AttributeError:
            return ""

    @staticmethod
    def CWEToLink(cwe):
        return "<a href=\"https://cwe.mitre.org/data/definitions/{0}.html\">CWE - {0}</a>".format(cwe)
