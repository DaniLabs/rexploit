from interfaces.iexploit import IExploit


class Exploit(IExploit):
    def __init__(self):
        super(Exploit, self).__init__(
            name="Attack login web via URL",
            category="bf",
            authors={
                "Daniel Diez": "RExploit module"
            },
            targets=[
                "All"
            ],
            date="11/04/2016",
            cwe="255",
            description="This a generic exploit for attack login panel via web (port 80). Test with credentials by default.",
        )

    def default(self):
        data = {"port": "80",
                "users": "wordlist/users.txt",
                "passwords": "wordlist/passwords.txt",
                "url": "login.html?user=[user]&password=[password]"}

        return data

    def run(self, data):
        port = data["port"]
        url = data["url"]
        users = data["users"]
        passwords = data["passwords"]
        # TODO Falta por implementar la fuerza bruta

        message = "Not working"
        return message

