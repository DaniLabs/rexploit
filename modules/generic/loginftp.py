from lib.interfaces.iexploit import IExploit
from modules.auxiliary.io import getContentFromFile


class Exploit(IExploit):
    def __init__(self):
        super(Exploit, self).__init__(
            name="Bruteforece FTP attack login",
            category="bf",
            authors={
                "Daniel Diez": "RExploit module"
            },
            targets=[
                "All"
            ],
            date="11/04/2016",
            cwe="CWE-255: Credentials Management",
            description="This a generic exploit for attack login via FTP (port 21). Test with credentials by default.",

        )

    def default(self):
        data = {"port": "21",
                "users": "wordlist/users.txt",
                "passwords": "wordlist/passwords.txt"
                }
        return data

    def run(self, data):
        port = data["port"]
        users = getContentFromFile(data["users"])
        passwords = getContentFromFile(data["passwords"])
        # TODO Falta por implementar la fuerza bruta

        message = "Not working"
        return message
