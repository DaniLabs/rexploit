from lib.interfaces.iexploit import IExploit
from modules.auxiliary.io import getContentFromFile


class Exploit(IExploit):
    def __init__(self):
        super(Exploit, self).__init__(
            name="Bruteforece attack login web",
            category="bfweb",
            authors={
                "Daniel Diez": "RExploit module"
            },
            targets=[
                "All"
            ],
            date="11/04/2016",
            cwe="CWE-255: Credentials Management",
            description="This a generic exploit for attack login panel via web (port 80). Test with credentials by default.",
        )

    def default(self):
        data = {"port": "80",
                "users": "wordlist/users.txt",
                "passwords": "wordlist/passwords.txt",
                "url": "login.html?user=[user]&password=[password]"
                }
        return data

    def run(self, data):
        port = data["port"]
        url = data["url"]
        users = getContentFromFile(data["users"])
        passwords = getContentFromFile(data["passwords"])
        # TODO Falta por implementar la fuerza bruta

        message = "Not working"
        return message

