import ConfigParser
import os


class ProjectModel(object):
    # Depends if we open a file (path) or if we create a new project (location + name)
    def __init__(self, *args ):
        self.__config = ConfigParser.ConfigParser()
        if len(args ) == 1:
            self.__fileName = str(args[0])
            self.__config.read(self.__fileName)
        elif len(args ) == 2:
            self.__fileName = os.path.join(str(args[0]), str(args[1]) + ".ini")

    def getFileName(self):
        return self.__fileName

    def writeOnSection(self, section, var, value):
        if not self.__config.has_section(section):
            self.__config.add_section(section)

        self.__config.set(section, var, value)
        self.save()

    def save(self):
        with open(self.__fileName, "w") as configfile:
            self.__config.write(configfile)

    def readValue(self, section, var):
        try:
            return self.__config.get(section, var)
        except ConfigParser.Error:
            return None

    def readSection(self, section):
        if self.hasSection(section):
            return self.__config.items(section)
        else:
            return None

    def hasSection(self, section):
        return self.__config.has_section(section)
