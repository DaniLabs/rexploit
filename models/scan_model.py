from scan_thread import ScanThread
from target_model import Target


#TODO Eliminar esta clase y refactorizarla a la de scan_thread.
class ScanModel:
    def __init__(self):
        self.t = None
        self.targets = []

    def thread(self):
        self.t = ScanThread()
        return self.t

    def start(self, host, ports):
        self.t.host = host
        self.t.ports = ports
        self.t.start()

    @staticmethod
    def parse_file(sections):
        targets = []
        for section in sections:
            target = Target()
            target.protocol = section[0][1]
            target.port = section[1][1]
            target.name = section[2][1]
            target.state = section[3][1]
            target.product = section[4][1]
            target.extra_info = section[5][1]
            targets.append(target)

        return targets
