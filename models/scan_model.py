from scan_thread import ScanThread
from target_model import Target


class ScanModel:
    def __init__(self):
        self.t = None
        self.targets = []

    def thread(self):
        if not self.t:
            self.t = ScanThread()
            return self.t
        else:
            return self.t

    def start(self, host, ports):
        self.t.host = host
        self.t.ports = ports
        self.t.start()

    def is_running(self):
        return self.t.isRunning()

    @staticmethod
    def parse_file(sections):
        targets = []
        for section in sections:
            target = Target()
            target.protocol = section[0][1]
            target.port = section[1][1]
            target.name = section[2][1]
            target.state = section[3][1]
            target.product = section[4][1]
            target.extra_info = section[5][1]
            targets.append(target)

        return targets

    @staticmethod
    def parse_table(item):
        target = Target()
        target.protocol = item[0]
        target.port = item[1]
        target.name = item[2]
        target.state = item[3]
        target.product = item[4]
        target.extra_info = item[5]

        return target
