import sqlite3

from lib.mac import getMACandOUI


class OUIModel(object):
    def __init__(self):
        self.cursor = None
        self.connect()

    def connect(self):
        connexion = sqlite3.connect('./models/db/oui.db')
        self.cursor = connexion.cursor()

    def fetchone(self, oui):
        data = (oui,)
        self.cursor.execute('SELECT * FROM oui WHERE oui LIKE ?', data )
        return self.cursor.fetchone()

    def getMACandOUI(self, ip):
        mac, oui = getMACandOUI(ip)
        return mac, self.fetchone(oui)
