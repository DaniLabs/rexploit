import ConfigParser
import os


class ProjectModel:
    # Depends if we open a file (path) or if we create a new project (location + name)
    def __init__(self, *args):
        self.config = ConfigParser.ConfigParser()
        if len(args) == 1:
            self.filename = str(args[0])
            self.config.read(self.filename)
        elif len(args) == 2:
            self.filename = os.path.join(str(args[0]), str(args[1]) + ".ini")

    def write_on_section(self, section, var, value):
        if not self.config.has_section(section):
            self.config.add_section(section)

        self.config.set(section, var, value)
        self.save()

    def save(self):
        with open(self.filename, "w") as configfile:
            self.config.write(configfile)

    def read_value(self, section, var):
        try:
            return self.config.get(section, var)
        except ConfigParser.Error:
            return None

    def read_section(self, section):
        if self.has_section(section):
            return self.config.items(section)
        else:
            return None

    def has_section(self, section):
        return self.config.has_section(section)

    def get_file(self):
        return self
