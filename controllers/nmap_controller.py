from views.nmap_scan_view import NmapScanView
from models.nmap_model import NmapModel

class NmapController(object):
    def __init__(self):
        self.model = NmapModel()
        self.nmap_scan_view = NmapScanView(self)
        self.project_file = None
        self.ip = None

    def get_widget(self):
        return self.nmap_scan_view.get_ui()

    def start_scan(self, ports):
        if self.ip and ports:
            self.model.set_host(self.ip)
            self.model.set_ports(ports)
            self.model.start()
            self.nmap_scan_view.set_items(self.model.get_targets())
        else:
            self.nmap_scan_view.error("IP or ports not found")

    def set_project_file(self, project_file):
        self.project_file = project_file
        self.set_ip()

    def set_ip(self):
        self.ip = self.project_file.read_value("Information", "IP")