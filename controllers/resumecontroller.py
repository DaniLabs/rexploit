from os import listdir
from os.path import splitext

from views.widgets.resumeview import ResumeView


class ResumeController(object):
    def __init__(self, parent):
        self.resumeView = ResumeView(self, parent)

        self.projectModel = None

    def getWidget(self):
        return self.resumeView

    def setProjectModel(self, projectModel):
        self.projectModel = projectModel

        data = [self.projectModel.readValue("Information", "Name"),
                self.projectModel.readValue("Information", "IP"),
                self.projectModel.readValue("Information", "MAC"),
                self.projectModel.readValue("Information", "OUI"),
                self.projectModel.readValue("Information", "COMPANY")]

        self.resumeView.setInformationProject(data)

    def getRouterActive(self):
        return self.resumeView.getRouterActive()

    def getModelActive(self):
        return self.resumeView.getModelActive()

    def getModelsForRouter(self, router):
        if router:
            try:
                models = [splitext(f)[0].split("_")[1].upper()
                          for f in listdir("./modules/{0}".format(router.lower()))
                            if f.endswith(".py") and not f.startswith("__")
                          ]
                self.resumeView.setModels(models)
            except ImportError:
                return None
        else:
            return None
