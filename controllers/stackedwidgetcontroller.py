# Imports
from views.exploits.authenticationbypass import AuthenticationBypassView
from views.exploits.generatorview import GeneratorView
from views.exploits.localfileinclusionview import LocalFileInclusionView
from views.exploits.informationdisclosure import InformationDisclosureView
from views.exploits.dictionary import DictionaryView
from views.exploits.dictionaryweb import DictionaryWebView
from views.exploits.backdoor import BackdoorView


class StackedWidgetController(object):

    """
        This class is a controller that manages a stacked widget.
        It is use to get a better control over exploits widgets
    """

    def __init__(self, parent):
        """Initialize the controller object and all attributes that it needs"""
        # Store all widgets
        self.__widgets = {}

        # Store the exploits' name as key and widget as value
        self.__exploits = {}

        self.__parent = parent

        self.addWidget(AuthenticationBypassView(parent))
        self.addWidget(BackdoorView(parent))
        self.addWidget(DictionaryView(parent))
        self.addWidget(DictionaryWebView(parent))
        self.addWidget(GeneratorView(parent))
        self.addWidget(InformationDisclosureView(parent))
        self.addWidget(LocalFileInclusionView(parent))

    def addWidget(self, widget):
        """
        Add a widget to dict
        :param widget: the widget that we want to add
        :return: None
        """
        widget.hide()
        self.__widgets[widget.getCategory()] = widget

    def getWidget(self, category):
        """
        Get the widget associate to the category and his parent
        :param category: category name
        :return: a widget
        """
        widget = self.__widgets[category]
        return widget.__class__(self.__parent)

    def setExploitWidget(self, name, widget):
        """
        Set the exploit's name as key and widget as value
        :param name: exploit's name
        :param widget: a widget
        :return: None
        """
        self.__exploits[name] = widget

    def getWidgetWithExploit(self, exploit):
        """
        Get the widget associate with this exploit name
        :param exploit: exploit's name
        :return: a widget
        """
        return self.__exploits[exploit] if exploit in self.__exploits else None
