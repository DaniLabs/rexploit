from os.path import expanduser


class ReportController(object):
    def __init__(self):
        self.__projectFile = None
        # self.__reportView = ReportView(self)

    def create(self):
        from reportlab.lib.pagesizes import letter
        from reportlab.pdfgen import canvas
        path = "{0}/{1}.pdf".format(str(expanduser("~")), self.__projectFile.readValue("Information", "Name"))
        canvas = canvas.Canvas(path, pagesize =letter)
        canvas.setLineWidth(.3)
        canvas.setFont('Helvetica', 12)

        canvas.drawString(30, 750, 'OFFICIAL REPORT')
        canvas.drawString(30, 735, 'BY REXPLOIT ')
        canvas.drawString(500, 750, "{0}".format(self.__projectFile.readValue("Information", "IP")))
        canvas.line(480, 747, 580, 747)

        canvas.drawString(275, 725, 'MAC:')
        canvas.drawString(500, 725, "{0}".format(self.__projectFile.readValue("Information", "MAC")))
        canvas.line(378, 723, 580, 723)

        canvas.drawString(30, 703, 'COMPANY:')
        canvas.line(120, 700, 580, 700)
        canvas.drawString(120, 703, "{0}".format(self.__projectFile.readValue("Information", "COmpany")))

        canvas.save()
        canvas.showPage()
        return path

    def setProjectFile(self, projectFile):
        self.__projectFile = projectFile

