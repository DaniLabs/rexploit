from PyQt5.uic import loadUi

from PyQt5.QtWidgets import QWidget

from views.misc.messagebox import MessageBox


class LocalFileInclusionView(QWidget):
    def __init__(self, parent):
        super(LocalFileInclusionView, self).__init__(parent)
        loadUi('./views/ui/modules/localfileinclusion.ui', self)
        self.exploit = None

        # Connect buttons
        self.pushButtonExploit.clicked.connect(self.pushButtonExploitClicked)

        # Set verticalLayout. It's resize the widget
        self.setLayout(self.verticalLayout)

    def setExploit(self, exploit):
        self.exploit = exploit

    def pushButtonExploitClicked(self):
        path = self.lineEditPath.text()
        if path:
            data = self.exploit.run(path)
            print data
            self.textBrowserData.append(data)
        else:
            MessageBox.critical("Error", "You must to add a path")

