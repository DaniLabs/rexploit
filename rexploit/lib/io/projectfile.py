from ConfigParser import ConfigParser, Error
from os.path import join


class ProjectFile(object):
    # Depends if we open a file (path) or if we create a new project (location + name)
    def __init__(self, *args):
        self.__config = ConfigParser()
        if len(args) == 1:
            self.__fileName = str(args[0])
            self.__config.read(self.__fileName)
        elif len(args) == 2:
            self.__fileName = join(str(args[0]), str(args[1]) + ".ini")

    def getFileName(self):
        return "/".join(self.__fileName.split("/")[:-1])

    def getSections(self, section):
        i = 0
        items = []
        while self.hasSection("{0}_{1}".format(section, i)):
            items.append(self.readSection("{0}_{1}".format(section, i)))
            i += 1

        return items

    def hasSection(self, section):
        return self.__config.has_section(section)

    def readValue(self, section, var):
        try:
            return str(self.__config.get(section, var))
        except Error:
            return None

    def readSection(self, section):
        return self.__config.items(section) if self.hasSection(section) else None

    def write(self, section, var, value):
        if not self.__config.has_section(section):
            self.__config.add_section(section)

        value = value.replace("'", "")
        self.__config.set(section, var, value)

        # Write changes on file
        with open(self.__fileName, "w") as configfile:
            self.__config.write(configfile)
