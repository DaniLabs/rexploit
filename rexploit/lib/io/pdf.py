from fpdf import FPDF
from datetime import date
from os.path import expanduser


class PDF(FPDF):
    def create(self):
        self.add_page()
        self.alias_nb_pages()
        self.set_font("Times", size=12)

    def header(self):
        # set the font for the header
        self.set_font("Arial", style="B", size=18)

        # page title
        self.cell(0, 10, "Router Exploitation Report create at {0}".format(date.today()), border=0, ln=0, align="C")

        # insert a line break of 20 pixels
        self.ln(20)

    def footer(self):
        # position footer at 15mm from the bottom
        self.set_y(-15)

        # set the font, I=italic
        self.set_font("Arial", style="I", size=8)

        # display the page number and center it
        pageNum = "Page %s/{nb}" % self.page_no()
        self.cell(0, 10, pageNum, align="C")

    def writeText(self, category, text, size):
        self.set_font("Times", style="B", size=12)
        self.cell(size, 1, category, 0)

        self.set_font("Times", size=12)
        self.cell(size, 1, text, ln=1)

        self.ln(5)

    def titleSection(self, section, level):
        if level == 1:
            self.set_font("Times", style="I", size=18)
            self.cell(0, 10, section, border=0, ln=1, align="C")
            self.ln(5)
        elif level == 2:
            self.set_font("Times", style="I", size=14)
            self.cell(0, 10, section, border=0, ln=1)
            self.ln(2)

    def save(self, path):
        if not path:
            path = expanduser("~")

        name = "{0}_{1}.pdf".format(path, date.today())
        self.output(name)
        self.open()
