# Imports
from rexploit.interfaces.dialog import Dialog
from rexploit.views.aux.messagebox import MessageBox


class AboutView(Dialog):

    """
        This class is a view inherit from QDialog. This class only shows some information about the project.
    """

    def __init__(self):
        """Initialize the view object and all attributes that it needs"""
        super(AboutView, self).__init__()

    def buttonBoxAccepted(self):
        """This function is executed when buttonBox OK is clicked."""
        self.accept()

    def startUi(self):
        """This function checks if ui file exists and then show the view"""
        try:
            from PyQt4.Qt import PYQT_VERSION_STR as PYQTVERSION
            from nmap import __version__ as NMAPVERSION
            from fpdf import __version__ as FPDVERSION
            from requests import __version__ as REQUESTSVERSION

            self.load('about')

            # Connect things
            self.buttonBox.accepted.connect(self.buttonBoxAccepted)

            # Add information
            self.labelTitle.setText('RExploit (Router Exploitation)')
            self.labelDescription.setText(
                "This program is written on Python 2.7\n"
                "This program uses pyqt4 ({0}), fpdf ({1}),\n"
                "python-nmap  ({2}) and requests ({3})\n\n"
                "Copyright(C) 2007 General Public License 3 (GPL3)\n".format(PYQTVERSION,
                                                                             FPDVERSION,
                                                                             NMAPVERSION,
                                                                             REQUESTSVERSION))
            return True
        except Exception as e:
            MessageBox.critical("Error", str(e))
            return False
